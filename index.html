<!-- Modal Gu√≠a R√°pida -->
<div id="modalGuiaRapida" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:#0007;z-index:5000;align-items:center;justify-content:center;">
    <div style="background:#fff;padding:32px 24px 24px 24px;border-radius:18px;box-shadow:0 8px 32px #0003;max-width:90vw;width:340px;text-align:left;position:relative;display:flex;flex-direction:column;align-items:center;">
        <div style="font-size:2em;color:#2176d2;margin-bottom:10px;"><i class='fa-solid fa-circle-info'></i></div>
        <div id="txtGuiaRapida" style="font-size:1.05em;line-height:1.5;margin-bottom:18px;text-align:left;max-height:320px;overflow:auto;"></div>
        <button id="btnCerrarGuiaRapida" style="background:#bbb;color:#333;padding:10px 22px;border:none;border-radius:8px;font-size:1em;cursor:pointer;">Cerrar</button>
    </div>
</div>
<button id="btnGuiaRapida" title="Gu√≠a r√°pida" style="position:fixed;bottom:100px;right:24px;z-index:9999;background:#2176d2;color:#fff;border:none;border-radius:50%;width:54px;height:54px;font-size:1.5em;box-shadow:0 4px 16px #0004;cursor:pointer;"><i class="fa-solid fa-circle-info"></i></button>
<script>
// Gu√≠a r√°pida multiling√ºe
function getGuiaRapida(lang) {
    switch(lang) {
        case 'en':
            return `
1. <b>Select your language</b> on the welcome screen. Everything translates automatically.<br><br>
2. <b>Create or edit your profile</b> with your data, photo, and logo. Use the pencil button to edit.<br><br>
3. <b>Share your card</b> with the share button:<br>
&nbsp;&nbsp;- On mobile: use the native menu (WhatsApp, Email, etc.).<br>
&nbsp;&nbsp;- On PC: copy and paste the data from the modal.<br><br>
4. <b>Manage your contacts</b> from the agenda:<br>
&nbsp;&nbsp;- Add, edit, delete, and search contacts.<br>
&nbsp;&nbsp;- Import from your mobile or export to CSV.<br><br>
5. <b>Customize colors and dark mode</b> with the top bar buttons.<br><br>
6. <b>Get birthday notifications</b> for your contacts and congratulate them quickly.<br><br>
Done! Your identity and contacts always at hand, easy to share and multilingual.`;
        case 'fr':
            return `
1. <b>S√©lectionnez votre langue</b> sur l'√©cran d'accueil. Tout est traduit automatiquement.<br><br>
2. <b>Cr√©ez ou modifiez votre profil</b> avec vos donn√©es, photo et logo. Utilisez le bouton crayon pour modifier.<br><br>
3. <b>Partagez votre carte</b> avec le bouton de partage :<br>
&nbsp;&nbsp;- Sur mobile : utilisez le menu natif (WhatsApp, Email, etc.).<br>
&nbsp;&nbsp;- Sur PC : copiez et collez les donn√©es depuis la fen√™tre.<br><br>
4. <b>G√©rez vos contacts</b> depuis l'agenda :<br>
&nbsp;&nbsp;- Ajoutez, modifiez, supprimez et recherchez des contacts.<br>
&nbsp;&nbsp;- Importez depuis votre mobile ou exportez en CSV.<br><br>
5. <b>Personnalisez les couleurs et le mode sombre</b> avec les boutons de la barre sup√©rieure.<br><br>
6. <b>Recevez des notifications d'anniversaire</b> de vos contacts et f√©licitez-les rapidement.<br><br>
Pr√™t ! Votre identit√© et vos contacts toujours √† port√©e de main, facile √† partager et multilingue.`;
        default:
            return `
1. <b>Selecciona tu idioma</b> en la pantalla de inicio. Todo se traduce autom√°ticamente.<br><br>
2. <b>Crea o edita tu perfil</b> con tus datos, foto y logo. Usa el bot√≥n de l√°piz para editar.<br><br>
3. <b>Comparte tu tarjeta</b> con el bot√≥n de compartir:<br>
&nbsp;&nbsp;- En m√≥vil: usa el men√∫ nativo (WhatsApp, Email, etc.).<br>
&nbsp;&nbsp;- En PC: copia y pega los datos desde el modal.<br><br>
4. <b>Gestiona tus contactos</b> desde la agenda:<br>
&nbsp;&nbsp;- Agrega, edita, elimina y busca contactos.<br>
&nbsp;&nbsp;- Importa desde tu m√≥vil o exporta a CSV.<br><br>
5. <b>Personaliza colores y modo oscuro</b> con los botones de la barra superior.<br><br>
6. <b>Recibe avisos de cumplea√±os</b> de tus contactos y felic√≠talos r√°pido.<br><br>
¬°Listo! Tu identidad y contactos siempre a mano, f√°cil de compartir y multiling√ºe.`;
    }
}
document.addEventListener('DOMContentLoaded', function() {
    var btnGuia = document.getElementById('btnGuiaRapida');
    var modalGuia = document.getElementById('modalGuiaRapida');
    var txtGuia = document.getElementById('txtGuiaRapida');
    var btnCerrarGuia = document.getElementById('btnCerrarGuiaRapida');
    function mostrarGuia() {
        var lang = (typeof getLang === 'function') ? getLang() : 'es';
        txtGuia.innerHTML = getGuiaRapida(lang);
        modalGuia.style.display = 'flex';
        modalGuia.style.alignItems = 'center';
        modalGuia.style.justifyContent = 'center';
    }
    if(btnGuia && modalGuia && txtGuia && btnCerrarGuia) {
        btnGuia.onclick = mostrarGuia;
        btnCerrarGuia.onclick = function() {
            modalGuia.style.display = 'none';
        };
    }
    // Refrescar gu√≠a autom√°ticamente al cambiar idioma (local y entre pesta√±as)
    function refrescarGuiaSiVisible() {
        if(modalGuia.style.display === 'flex') mostrarGuia();
    }
    // Cambios de idioma en la misma pesta√±a
    if (typeof window.setLang === 'function') {
        var originalSetLang = window.setLang;
        window.setLang = function(lang) {
            originalSetLang.apply(this, arguments);
            setTimeout(refrescarGuiaSiVisible, 50);
        };
    } else {
        // fallback: observar cambios manuales en el selector
        var selector = document.getElementById('selectorIdioma');
        if(selector) selector.addEventListener('change', function(){
            setTimeout(refrescarGuiaSiVisible, 50);
        });
    }
    // Cambios de idioma en otras pesta√±as
    window.addEventListener('storage', function(e) {
        if(e.key === 'lang') setTimeout(refrescarGuiaSiVisible, 100);
    });
});
</script>
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><script>document.write(t('id_digital_local'))</script></title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
                        /* Bot√≥n de instalaci√≥n moderno */
                        #btnInstalarApp {
                            background: linear-gradient(90deg, #2176d2 60%, #25D366 100%);
                            color: #fff;
                            border: none;
                            border-radius: 18px;
                            padding: 12px 0;
                            width: 100%;
                            font-size: 1.08em;
                            font-weight: 600;
                            box-shadow: 0 2px 8px #0001;
                            cursor: pointer;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            gap: 10px;
                            margin-top: 14px;
                            transition: background 0.2s, box-shadow 0.2s;
                        }
                        #btnInstalarApp:hover {
                            background: linear-gradient(90deg, #25D366 60%, #2176d2 100%);
                            box-shadow: 0 4px 16px #25D36644;
                        }
                /* Selector de idioma moderno */
                #selectorIdioma {
                    background: #f4f4f4;
                    color: #2176d2;
                    border: 1.5px solid #25D366;
                    border-radius: 18px;
                    padding: 8px 18px 8px 36px;
                    font-size: 1.08em;
                    font-weight: 600;
                    box-shadow: 0 2px 8px #0001;
                    outline: none;
                    appearance: none;
                    -webkit-appearance: none;
                    -moz-appearance: none;
                    background-image: url('data:image/svg+xml;utf8,<svg fill="%232176d2" height="20" viewBox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
                    background-repeat: no-repeat;
                    background-position: 10px center;
                    transition: border 0.2s, box-shadow 0.2s;
                }
                #selectorIdioma:focus {
                    border: 2px solid #2176d2;
                    box-shadow: 0 0 0 2px #25D36644;
                }
                #selectorIdioma option {
                    background: #fff;
                    color: #2176d2;
                    font-weight: 600;
                }
        body {
            min-height: 100vh;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #2176d2 0%, #25D366 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        .main-card {
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 4px 24px #0002;
            padding: 32px 22px 28px 22px;
            max-width: 370px;
            width: 92vw;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .main-title {
            font-size: 2em;
            font-weight: bold;
            color: #2176d2;
            margin-bottom: 10px;
            text-align: center;
        }
        .main-desc {
            color: #444;
            font-size: 1.08em;
            margin-bottom: 28px;
            text-align: center;
        }
        .main-btn {
            background: #25D366;
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 13px 0;
            width: 100%;
            font-size: 1.15em;
            font-weight: bold;
            box-shadow: 0 2px 8px #0001;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: background 0.2s;
        }
        .main-btn:hover {
            background: #2176d2;
        }
        @media (max-width: 480px) {
            .main-card { padding: 18px 6vw 18px 6vw; }
            .main-title { font-size: 1.4em; }
        }
    </style>
</head>
<body>
            <!-- Modal sugerencia instalaci√≥n -->
            <div id="modalInstalar" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:#0007;z-index:2000;align-items:center;justify-content:center;">
                <div style="background:#fff;padding:28px 18px 18px 18px;border-radius:18px;max-width:340px;width:90vw;box-shadow:0 4px 24px #2176d244;display:flex;flex-direction:column;align-items:center;">
                    <div style="font-size:2.2em;color:#25D366;margin-bottom:10px;"><i class="fa-solid fa-download"></i></div>
                    <div id="modalMsgInstalar" style="font-size:1.1em;color:#2176d2;margin-bottom:16px;text-align:center;">¬øQuieres instalar esta app en tu dispositivo para acceder m√°s r√°pido y sin conexi√≥n?</div>
                    <div id="modalMsgShortcut" style="font-size:0.98em;color:#444;margin-bottom:14px;text-align:center;display:none;"></div>
                    <button id="btnVerInstrucciones" style="background:#e0e0e0;color:#2176d2;border:none;border-radius:12px;padding:7px 18px;font-size:0.98em;font-weight:600;cursor:pointer;margin-bottom:10px;">¬øC√≥mo crear acceso directo?</button>
                    <div id="pasosShortcut" style="display:none;font-size:0.97em;color:#2176d2;background:#f4f4f4;border-radius:10px;padding:12px 10px;margin-bottom:10px;text-align:left;"></div>
                    <button id="modalBtnCerrar" style="background:#eee;color:#2176d2;border:none;border-radius:14px;padding:8px 18px;font-size:0.98em;font-weight:600;cursor:pointer;">Ahora no</button>
                </div>
            </div>
    <div class="main-card">

            <div style="width:100%;display:flex;justify-content:center;margin-top:24px;">
                <button id="btnDescargarApp" title="Descargar/Instalar app" aria-label="Descargar/Instalar app" style="background:linear-gradient(135deg,#25D366 60%,#2176d2 100%);color:#fff;border:none;border-radius:50%;width:60px;height:60px;box-shadow:0 4px 16px #25D36644,0 1.5px 6px #2176d233;display:flex;align-items:center;justify-content:center;font-size:2em;cursor:pointer;transition:background 0.2s;">
                    <i class="fa-solid fa-download"></i>
                </button>
            </div>
                <!-- Modal de ayuda para instalar/descargar -->
                <div id="modalAyudaDescarga" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:#0007;z-index:3000;align-items:center;justify-content:center;">
                    <div style="background:#fff;padding:28px 18px 18px 18px;border-radius:18px;max-width:340px;width:90vw;box-shadow:0 4px 24px #2176d244;display:flex;flex-direction:column;align-items:center;">
                        <div style="font-size:2.2em;color:#25D366;margin-bottom:10px;"><i class="fa-solid fa-download"></i></div>
                        <div id="txtAyudaDescarga" style="font-size:1.1em;color:#2176d2;margin-bottom:16px;text-align:center;"></div>
                        <button id="btnCerrarAyudaDescarga" style="background:#eee;color:#2176d2;border:none;border-radius:14px;padding:8px 18px;font-size:0.98em;font-weight:600;cursor:pointer;">Cerrar</button>
                    </div>
                </div>
                <script>
                // Traducci√≥n para el bot√≥n y modal de descarga/instalaci√≥n
                function esMovil() {
                    return /Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent);
                }
                function traducirDescargaApp() {
                    var lang = (typeof getLang === 'function') ? getLang() : 'es';
                    var isMobile = esMovil();
                    var textos = {
                        es: {
                            tooltip: 'Descargar/Instalar app',
                            ayuda: isMobile
                                ? 'En tu m√≥vil, abre el men√∫ del navegador (‚ãÆ o ‚¨ÜÔ∏è) y selecciona <b>"Agregar a pantalla de inicio"</b> o <b>"Instalar app"</b>.'
                                : 'En tu ordenador, abre el men√∫ del navegador (‚ãÆ o ‚â°) y selecciona <b>"Instalar app"</b> o <b>"Agregar a pantalla de inicio"</b>.'
                        },
                        en: {
                            tooltip: 'Download/Install app',
                            ayuda: isMobile
                                ? 'On your mobile, open the browser menu (‚ãÆ or ‚¨ÜÔ∏è) and select <b>"Add to Home Screen"</b> or <b>"Install app"</b>.'
                                : 'On your computer, open the browser menu (‚ãÆ or ‚â°) and select <b>"Install app"</b> or <b>"Add to Home Screen"</b>.'
                        },
                        fr: {
                            tooltip: 'T√©l√©charger/Installer l\'app',
                            ayuda: isMobile
                                ? 'Sur votre mobile, ouvrez le menu du navigateur (‚ãÆ ou ‚¨ÜÔ∏è) et s√©lectionnez <b>"Ajouter √† l\'√©cran d\'accueil"</b> ou <b>"Installer l\'application"</b>.'
                                : 'Sur votre ordinateur, ouvrez le menu du navigateur (‚ãÆ ou ‚â°) et s√©lectionnez <b>"Installer l\'application"</b> ou <b>"Ajouter √† l\'√©cran d\'accueil"</b>.'
                        }
                    };
                    var btn = document.getElementById('btnDescargarApp');
                    if(btn) {
                        btn.title = textos[lang].tooltip;
                        btn.setAttribute('aria-label', textos[lang].tooltip);
                    }
                    var ayudaDiv = document.getElementById('txtAyudaDescarga');
                    if(ayudaDiv) {
                        ayudaDiv.innerHTML = textos[lang].ayuda;
                        ayudaDiv.style.display = 'block';
                    }
                }
                document.addEventListener('DOMContentLoaded', function() {
                    traducirDescargaApp();
                    var btnDescargar = document.getElementById('btnDescargarApp');
                    var modalAyuda = document.getElementById('modalAyudaDescarga');
                    var btnCerrarAyuda = document.getElementById('btnCerrarAyudaDescarga');
                    if(btnDescargar && modalAyuda && btnCerrarAyuda) {
                        btnDescargar.onclick = function() {
                            // Intentar disparar el prompt de instalaci√≥n si es posible
                            if(window.deferredPrompt) {
                                window.deferredPrompt.prompt();
                            } else {
                                traducirDescargaApp(); // Asegura texto correcto seg√∫n dispositivo
                                modalAyuda.style.display = 'flex';
                                modalAyuda.style.alignItems = 'center';
                                modalAyuda.style.justifyContent = 'center';
                            }
                        };
                        btnCerrarAyuda.onclick = function() {
                            modalAyuda.style.display = 'none';
                        };
                    }
                    // Sincronizar traducci√≥n si cambia el idioma global
                    window.addEventListener('storage', function(e) {
                        if(e.key === 'lang') setTimeout(traducirDescargaApp, 100);
                    });
                    // Sincronizar idioma y recargar usando setLang para garantizar traducci√≥n y persistencia
                    var selector = document.getElementById('selectorIdioma');
                    if(selector) {
                        selector.addEventListener('change', function() {
                            if(typeof setLang === 'function') {
                                setLang(this.value);
                            } else {
                                localStorage.setItem('lang', this.value);
                                location.reload();
                            }
                        });
                    }
                });
                </script>
        <div class="welcome-logo" style="width:110px;height:110px;border-radius:28px;margin-bottom:22px;background:linear-gradient(135deg,#2176d2 60%,#25D366 100%);display:flex;align-items:center;justify-content:center;box-shadow:0 4px 24px #2176d244;font-size:4em;color:#fff;">
            <i class="fa-solid fa-id-card"></i>
        </div>
        <div class="main-title" id="tituloBienvenida"><script>document.write(t('id_digital_local'))</script></div>
        <div class="main-desc" id="descBienvenida"><script>document.write(t('desc_bienvenida'))</script></div>
        <button class="main-btn" onclick="window.location.href='ID.html'">
            <i class="fa-solid fa-arrow-right"></i> <span id="txtEmpezar"><script>document.write(t('empezar'))</script></span>
        </button>
    </div>

<!-- Selector de idioma flotante sincronizado -->
<div id="selectorIdiomaFlotante" style="position:fixed;bottom:24px;right:24px;z-index:9999;background:#2176d2;border-radius:50px;box-shadow:0 4px 16px #0004;padding:8px 18px;display:flex;align-items:center;gap:8px;">
    <label for="idiomaFlotante" style="color:#fff;font-weight:bold;font-size:1.1em;margin:0;cursor:pointer;">üåê</label>
    <select id="idiomaFlotante" style="border:none;border-radius:8px;padding:6px 10px;font-size:1em;outline:none;">
        <option value="es">Espa√±ol</option>
        <option value="en">English</option>
        <option value="fr">Fran√ßais</option>
    </select>
</div>
<script>
    // Sincronizar selector con idioma actual y memorizar siempre el √∫ltimo idioma seleccionado
    function getLangActual() {
        return localStorage.getItem('lang') || 'es';
    }
    function setLangActual(lang) {
        localStorage.setItem('lang', lang);
        if(typeof t === 'function' && typeof traducirBienvenida === 'function') {
            traducirBienvenida();
        }
        window.dispatchEvent(new Event('storage'));
    }
    var sel = document.getElementById('idiomaFlotante');
    if(sel) {
        // Al cargar, aplicar el idioma guardado
        sel.value = getLangActual();
        if(typeof setLang === 'function') setLang(sel.value);
        sel.onchange = function() {
            setLangActual(this.value);
            if(typeof setLang === 'function') setLang(this.value);
        };
        // Actualizar el valor si cambia desde otro lugar
        window.addEventListener('storage', function() {
            sel.value = getLangActual();
            if(typeof setLang === 'function') setLang(sel.value);
        });
    }
</script>
        <script>

                // Mostrar modal de sugerencia de instalaci√≥n si es posible
                let deferredPromptModal;
                window.addEventListener('beforeinstallprompt', (e) => {
                    e.preventDefault();
                    deferredPromptModal = e;
                    setTimeout(() => {
                        document.getElementById('modalInstalar').style.display = 'flex';
                    }, 600);
                });
                document.getElementById('modalBtnInstalar').onclick = function() {
                    if (deferredPromptModal) {
                        deferredPromptModal.prompt();
                        deferredPromptModal.userChoice.then(() => {
                            deferredPromptModal = null;
                            document.getElementById('modalInstalar').style.display = 'none';
                        });
                    }
                };
                document.getElementById('modalBtnCerrar').onclick = function() {
                    // (El evento se reasigna din√°micamente al abrir el modal)
                };
        // Registrar service worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
        </script>
        <script src="lang.js"></script>
            <script>
            let deferredPrompt;
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                document.getElementById('btnInstalarApp').style.display = 'flex';
            });
            document.getElementById('btnInstalarApp').onclick = function() {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        deferredPrompt = null;
                        document.getElementById('btnInstalarApp').style.display = 'none';
                    });
                }
            };
            </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
                        function traducirBienvenida() {
                                                                                                var btnInstrucciones = document.getElementById('btnVerInstrucciones');
                                                                                                if(btnInstrucciones) {
                                                                                                    btnInstrucciones.textContent = {
                                                                                                        es: '¬øC√≥mo crear acceso directo?',
                                                                                                        en: 'How to create shortcut?',
                                                                                                        fr: 'Comment cr√©er un raccourci ?'
                                                                                                    }[getLang()];
                                                                                                }
                                                                                                var pasos = document.getElementById('pasosShortcut');
                                                                                                if(pasos) pasos.style.display = 'none';
                                                                                // Mostrar instrucciones paso a paso al pulsar el bot√≥n
                                                                                document.getElementById('btnVerInstrucciones').onclick = function() {
                                                                                    var pasos = document.getElementById('pasosShortcut');
                                                                                    var idioma = getLang();
                                                                                    var textos = {
                                                                                        es: '<b>Windows:</b><br>1. Instala la app.<br>2. Abre el men√∫ de inicio, busca "ID Digital Local".<br>3. Haz clic derecho y elige "Anclar a la barra de tareas" o "Anclar al escritorio".<br><br><b>Android:</b><br>1. Instala la app.<br>2. El acceso directo aparecer√° autom√°ticamente en la pantalla de inicio.<br><br><b>iPhone/iPad:</b><br>1. Abre Safari.<br>2. Toca el bot√≥n de compartir.<br>3. Selecciona "Agregar a pantalla de inicio".',
                                                                                        en: '<b>Windows:</b><br>1. Install the app.<br>2. Open the start menu, search for "ID Digital Local".<br>3. Right-click and choose "Pin to taskbar" or "Pin to desktop".<br><br><b>Android:</b><br>1. Install the app.<br>2. The shortcut will appear automatically on the home screen.<br><br><b>iPhone/iPad:</b><br>1. Open Safari.<br>2. Tap the share button.<br>3. Select "Add to Home Screen".',
                                                                                        fr: '<b>Windows :</b><br>1. Installez l‚Äôapplication.<br>2. Ouvrez le menu d√©marrer, cherchez "ID Digital Local".<br>3. Faites un clic droit et choisissez "√âpingler √† la barre des t√¢ches" ou "√âpingler au bureau".<br><br><b>Android :</b><br>1. Installez l‚Äôapplication.<br>2. Le raccourci appara√Ætra automatiquement sur l‚Äô√©cran d‚Äôaccueil.<br><br><b>iPhone/iPad :</b><br>1. Ouvrez Safari.<br>2. Touchez le bouton de partage.<br>3. S√©lectionnez "Ajouter √† l‚Äô√©cran d‚Äôaccueil".'
                                                                                    };
                                                                                    pasos.innerHTML = textos[idioma];
                                                                                    pasos.style.display = 'block';
                                                                                };
                                                                var msgShortcut = document.getElementById('modalMsgShortcut');
                                                                if(msgShortcut) {
                                                                    let instrucciones = {
                                                                        es: 'Despu√©s de instalar, busca la app en tu men√∫ de aplicaciones. En Windows puedes anclarla al escritorio desde el men√∫ de inicio. En Android aparecer√° en la pantalla de inicio. En iPhone, usa Safari y selecciona ‚ÄúAgregar a pantalla de inicio‚Äù en el men√∫ de compartir.',
                                                                        en: 'After installing, find the app in your apps menu. On Windows you can pin it to the desktop from the start menu. On Android it will appear on the home screen. On iPhone, use Safari and select ‚ÄúAdd to Home Screen‚Äù from the share menu.',
                                                                        fr: 'Apr√®s l‚Äôinstallation, trouvez l‚Äôapplication dans votre menu d‚Äôapplications. Sous Windows, vous pouvez l‚Äô√©pingler au bureau depuis le menu d√©marrer. Sur Android, elle appara√Ætra sur l‚Äô√©cran d‚Äôaccueil. Sur iPhone, utilisez Safari et s√©lectionnez ¬´¬†Ajouter √† l‚Äô√©cran d‚Äôaccueil¬†¬ª dans le menu de partage.'
                                                                    };
                                                                    msgShortcut.textContent = instrucciones[getLang()];
                                                                    msgShortcut.style.display = 'block';
                                                                }
                                document.getElementById('tituloBienvenida').textContent = t('bienvenido');
                                document.getElementById('descBienvenida').textContent = {
                                        es: 'Gestiona y comparte tu identidad digital y contactos de forma f√°cil, r√°pida y segura desde tu m√≥vil o PC.',
                                        en: 'Manage and share your digital identity and contacts easily, quickly and securely from your mobile or PC.',
                                        fr: 'G√©rez et partagez votre identit√© num√©rique et vos contacts facilement, rapidement et en toute s√©curit√© depuis votre mobile ou PC.'
                                }[getLang()];
                                document.getElementById('txtEmpezar').textContent = t('empezar');
                                document.getElementById('txtInstalar').textContent = {
                                        es: 'Instalar app',
                                        en: 'Install app',
                                        fr: 'Installer l\'app'
                                }[getLang()];
                                // Asegura que el bot√≥n de instalaci√≥n tambi√©n se traduzca si est√° visible
                                var btnInstalarApp = document.getElementById('btnInstalarApp');
                                var spanTxtInstalar = document.getElementById('txtInstalar');
                                if(btnInstalarApp && spanTxtInstalar) {
                                    spanTxtInstalar.textContent = {
                                        es: 'Instalar app',
                                        en: 'Install app',
                                        fr: 'Installer l\'app'
                                    }[getLang()];
                                }
                                var btnModal = document.getElementById('modalBtnInstalar');
                                if(btnModal) {
                                    btnModal.textContent = {
                                        es: 'Instalar app',
                                        en: 'Install app',
                                        fr: 'Installer l\'app'
                                    }[getLang()];
                                }

                                var msgModal = document.getElementById('modalMsgInstalar');
                                if(msgModal) {
                                    msgModal.textContent = {
                                        es: '¬øQuieres instalar esta app en tu dispositivo para acceder m√°s r√°pido y sin conexi√≥n?',
                                        en: 'Do you want to install this app on your device for faster and offline access?',
                                        fr: 'Voulez-vous installer cette application sur votre appareil pour un acc√®s plus rapide et hors ligne ?'
                                    }[getLang()];
                                }
                                var btnCerrar = document.getElementById('modalBtnCerrar');
                                if(btnCerrar) {
                                    btnCerrar.textContent = {
                                        es: 'Cerrar',
                                        en: 'Close',
                                        fr: 'Fermer'
                                    }[getLang()];
                                }
                        }
            traducirBienvenida();
            const selector = document.getElementById('selectorIdioma');
            selector.value = getLang();
            selector.onchange = function() {
                localStorage.setItem('lang', this.value);
                traducirBienvenida();
            };
        });
    </script>
</div>
<script>
    document.querySelector('.main-btn').onclick = function() {
        let data = localStorage.getItem('profileData');
        let isEmpty = true;
        if (data) {
            try {
                let obj = JSON.parse(data);
                // Considera lleno si tiene nombre y empresa
                if ((obj && (obj.nombre || obj.empresa))) {
                    isEmpty = false;
                }
            } catch(e) {}
        }
        if (isEmpty) {
            window.location.href = 'Formulario de perfil.html';
        } else {
            window.location.href = 'ID.html';
        }
    };
</script>
</body>


<script>
(function prepararAlertaCumpleIndex() {
    function preparar() {
        const data = JSON.parse(localStorage.getItem('profileData') || '{}');
        if (data && data.nacimiento && typeof data.nacimiento === 'string' && data.nacimiento.length >= 10) {
            const hoy = new Date();
            const mes = (hoy.getMonth() + 1).toString().padStart(2, '0');
            const dia = hoy.getDate().toString().padStart(2, '0');
            const hoyMesDia = mes + '-' + dia;
            if (data.nacimiento.slice(5, 10) === hoyMesDia) {
                // Mostrar icono flotante
                var icono = document.getElementById('iconoCumpleIndex');
                if(icono) icono.style.display = 'flex';
                // Preparar modal
                let mensaje = '';
                let nombre = data.nombre || '';
                if (typeof t === 'function') {
                    if (getLang && getLang() === 'en') {
                        mensaje = `üéâ <b>Today is the birthday of:</b><br>${nombre}`;
                    } else if (getLang && getLang() === 'fr') {
                        mensaje = `üéâ <b>Aujourd'hui c'est l'anniversaire de :</b><br>${nombre}`;
                    } else {
                        mensaje = `üéâ <b>Hoy es el cumplea√±os de:</b><br>${nombre}`;
                    }
                } else {
                    mensaje = `üéâ <b>Hoy es el cumplea√±os de:</b><br>${nombre}`;
                }
                var msgDiv = document.getElementById('msgCumpleIndex');
                var accionesDiv = document.getElementById('accionesCumpleIndex');
                var modal = document.getElementById('modalCumpleIndex');
                var btnCerrar = document.getElementById('cerrarModalCumpleIndex');
                if (msgDiv && accionesDiv && modal && btnCerrar) {
                    msgDiv.innerHTML = mensaje;
                    let acciones = '';
                    if(data.whatsapp) {
                        let msg = encodeURIComponent((typeof t==='function'?t('feliz_cumple'):'¬°Feliz cumplea√±os!') + ' ' + nombre);
                        let num = data.whatsapp.replace(/[^0-9]/g, '');
                        acciones += `<a href='https://wa.me/${num}?text=${msg}' target='_blank' style='background:#25D366;color:#fff;padding:10px 18px;border-radius:8px;margin:4px 2px;display:inline-block;text-decoration:none;font-weight:bold;font-size:1.1em;'><i class='fa-brands fa-whatsapp'></i> WhatsApp ${nombre}</a>`;
                    }
                    if(data.email) {
                        let subject = encodeURIComponent((typeof t==='function'?t('feliz_cumple'):'Feliz cumplea√±os'));
                        let body = encodeURIComponent((typeof t==='function'?t('feliz_cumple'):'Feliz cumplea√±os') + ' ' + nombre);
                        acciones += `<a href='mailto:${data.email}?subject=${subject}&body=${body}' style='background:#2176d2;color:#fff;padding:10px 18px;border-radius:8px;margin:4px 2px;display:inline-block;text-decoration:none;font-weight:bold;font-size:1.1em;'><i class='fa-solid fa-envelope'></i> Email ${nombre}</a>`;
                    }
                    accionesDiv.innerHTML = acciones;
                    // Click en icono muestra modal
                    if(icono) icono.onclick = function() {
                        modal.style.display = 'flex';
                    };
                    btnCerrar.onclick = function() {
                        modal.style.display = 'none';
                    };
                }
            }
        }
    }
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', preparar);
    } else {
        setTimeout(preparar, 50);
    }
})();
</script>
</html>

